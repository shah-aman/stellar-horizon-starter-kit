# Production Environment Configuration for Stellar Horizon
# OPTIMIZED FOR 30-DAY DATA RETENTION ON LINUX VM

# === DATABASE CONFIGURATION ===
# CRITICAL: Generate a strong password and keep it secure
# Use: openssl rand -base64 32
DB_PASSWORD=CHANGE_THIS_TO_A_STRONG_PASSWORD

# === NETWORK CONFIGURATION ===
# Stellar network to connect to: pubnet, testnet, or futurenet
# For production server, typically pubnet
STELLAR_NETWORK=pubnet

# === 30-DAY DATA RETENTION CONFIGURATION ===
# Enable ingestion (set to false for read-only API nodes)
INGEST=true

# Number of ledgers to retain - CONFIGURED FOR EXACTLY 30 DAYS
# Calculation: 30 days Ã— 17,280 ledgers/day = 518,400 ledgers
# This provides exactly 30 days of transaction history
HISTORY_RETENTION_COUNT=518400

# === PERFORMANCE OPTIMIZATION FOR 30-DAY SYNC ===
# Parallel job size optimized for faster initial sync with 30-day retention
PARALLEL_JOB_SIZE=100000

# Enable parallel history downloads for faster initial sync
PARALLEL_HISTORY_ARCHIVE_DOWNLOADS=4

# Captive core storage optimization
CAPTIVE_CORE_STORAGE_PATH=/var/horizon/core

# === MONITORING AND ADMIN ===
# Admin port for metrics and pprof
ADMIN_PORT=6060

# Log level: info recommended for production (debug for troubleshooting)
LOG_LEVEL=info

# === DATABASE OPTIMIZATION FOR 30-DAY RETENTION ===
# Maximum database connections (optimized for 30-day workload)
MAX_DB_CONNECTIONS=50

# === PRODUCTION API SETTINGS ===
# Rate limiting (requests per hour) - adjust based on expected API usage
PER_HOUR_RATE_LIMIT=7200

# Network timeouts (in seconds)
HTTP_REQUEST_TIMEOUT=30
CAPTIVE_CORE_HTTP_TIMEOUT=30

# === DISK USAGE ESTIMATES FOR 30-DAY RETENTION ===
# Expected storage requirements on your VM:
#
# PostgreSQL Database (17.6TB disk - /data/postgres):
# - Processed data: ~150-300GB (30 days)
# - Indexes: ~50-100GB
# - WAL files: ~10-20GB
# - Backups: ~50-100GB
# - Total: ~260-520GB (plenty of space on 17.6TB disk)
#
# Captive Core Storage (32TB disk - /data/horizon):
# - History archives: ~200-500GB (during sync)
# - Ledger buckets: ~100-200GB (steady state)
# - Temporary files: ~50-100GB
# - Total: ~350-800GB (plenty of space on 32TB disk)
#
# TOTAL STORAGE NEEDED: ~610GB-1.3TB (well within your capacity)

# === INITIAL SYNC TIME ESTIMATES ===
# Expected sync times for 30-day retention:
# - Testnet: 2-4 hours (smaller dataset)
# - Pubnet: 12-24 hours (larger dataset, depends on network)
# - Futurenet: 1-3 hours (newest network, smaller dataset)
#
# Note: Initial sync downloads full history then processes it.
# After initial sync, ongoing sync is real-time (5-second intervals).

# === RESOURCE RECOMMENDATIONS ===
# For optimal 30-day retention performance:
# - RAM: 16GB minimum, 32GB recommended
# - CPU: 8+ cores recommended
# - Network: Stable high-bandwidth connection
# - Disk: Your 32TB + 17.6TB setup is perfect

# === MONITORING CONFIGURATION ===
# Enable detailed monitoring for production
ENABLE_ASSET_STATS=true
ENABLE_EXPERIMENTAL_INGESTION=false

# === BACKUP SETTINGS ===
# Automated backup retention (days)
BACKUP_RETENTION_DAYS=7

# === SECURITY SETTINGS ===
# Disable admin endpoints on public interface (security)
DISABLE_ADMIN_ON_PUBLIC_HTTP=true

# === OPTIONAL: ADVANCED TUNING ===
# Uncomment and adjust these for fine-tuning if needed

# Transaction submission settings
# DISABLE_TX_SUB=false

# Asset statistics (can be resource intensive)
# ENABLE_ASSET_STATS=true

# Connection pool settings for high-load scenarios
# DB_MAX_OPEN_CONNECTIONS=20
# DB_MAX_IDLE_CONNECTIONS=5

# Captive core specific settings
# CAPTIVE_CORE_USE_DB=false 